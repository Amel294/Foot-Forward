<!-- tap to top Section Start -->

<!-- tap to top Section End -->

<div class="bg-overlay"></div>

<!-- latest jquery-->

<!-- Bootstrap js-->
<script src="/static/user/js/bootstrap/bootstrap.bundle.min.js"></script>

<!-- feather icon js-->
<script src="/static/user/js/feather/feather.min.js"></script>

<!-- lazyload js-->
<script src="/static/user/js/lazysizes.min.js"></script>

<!-- Slick js-->
<script src="/static/user/js/slick/slick.js"></script>
<script src="/static/user/js/slick/slick-animation.min.js"></script>
<script src="/static/user/js/slick/custom_slick.js"></script>

<!-- newsletter js -->
<script src="/static/user/js/newsletter.js"></script>

<!-- add to cart modal resize -->
<script src="/static/user/js/cart_modal_resize.js"></script>

<!-- Add To Home js -->
<script src="/static/user/js/pwa.js"></script>

<!-- add to cart modal resize -->
<script src="/static/user/js/cart_modal_resize.js"></script>

<!-- feather icon js-->
<!-- <script src="/static/user/js/timer1.js"></script> -->

<!-- notify js -->
<script src="/static/user/js/bootstrap/bootstrap-notify.min.js"></script>

<!-- script js -->
<script src="/static/user/js/theme-setting.js"></script>
<script src="/static/user/js/script.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src=/static/user/js/custom/userValidation.js></script>
<!-- Include Elevate Zoom -->

<!-- Bootstrap JS, Popper.js, and jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="/static/user/js/custom/dashboard_address.js"></script>
<script>
  function toggleHeart(element) {
    element.classList.toggle('active');
  }

</script>
<!-- Add your Slick carousel initialization script at the bottom of your page -->
<script>
  $(document).ready(function () {
    // Main slider
    $('.slick-slider-main').slick({
      slidesToShow: 1,
      slidesToScroll: 1,
      arrows: true,
      fade: true,
      asNavFor: '.slick-slider-nav'
    });

    // Navigation slider
    $('.slick-slider-nav').slick({
      slidesToShow: 3,
      slidesToScroll: 1,
      asNavFor: '.slick-slider-main',
      dots: true,
      centerMode: true,
      focusOnSelect: true
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const logoutLink = document.getElementById("logout_main_nav");

    logoutLink.addEventListener("click", function (event) {
      event.preventDefault();

      // Send a POST request to /logout using fetch
      fetch("/logout", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        // You can include any data you want to send with the request
        // For example, you might want to include a CSRF token if your server requires it
        body: JSON.stringify({}),
      })
        .then((response) => {
          if (response.status === 200) {
            // Successful logout, you can handle the redirection here if needed
            window.location.href = "/products"; // Redirect to the homepage
          } else {
            // Handle other response statuses (e.g., error)
            console.error("Logout failed");
          }
        })
        .catch((error) => {
          console.error("Error occurred during logout:", error);
        });
    });
  });

</script>


<script>
  document.getElementById('placeOrderButton').addEventListener('click', function (e) {
    var selectedAddress = document.querySelector('input[name="selectedAddress"]:checked');
    if (!selectedAddress) {
      alert('Please select an address.');
      e.preventDefault(); // Prevent the form from submitting
    } else {
      // Proceed with form submission
      // This part depends on how you handle form submission (e.g., using fetch API or traditional form post)
    }
  });


</script>

<script>
  // Define a function to update the cart HTML
  async function updateCartHtml() {
      try {
        // Fetch the cart data from the server
        console.log("Sending a request to /small-cart");
        const response = await fetch('http://localhost:3000/small-cart');
        const cart = await response.json();

        console.log('Fetched cart data:', cart); // Log the fetched cart data

        // Define where you'll insert the cart HTML
        const cartContainer = document.querySelector('#small_cart');

        // Start building the cart HTML
        let cartHtml = `
          <div class="your-cart-box">
            <h3 class="mb-3 d-flex text-capitalize">Your cart
              <span class="badge bg-theme new-badge rounded-pill ms-auto bg-dark">${cart.cartItem.length}</span>
            </h3>
            <ul class="list-group mb-3">`;

        // Calculate total and build list items
        let total = cart.total;

        console.log("length is : " + cart.cartItem.length);
        cart.cartItem.forEach(item => {
          // Ensure that item.product and item.product.price are valid references
          cartHtml += `
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div>
                <h6 class="my-0">${item.product}</h6>
                <small class="text-muted">Color: ${item.color}</small>
                <br>
                <small class="text-muted">Size: ${item.size}</small>
                <br>
                <small class="text-muted">Quantity: ${item.quantity}</small>
              </div>
              <span class="text-muted">₹${item.itemTotal.toFixed(2)}</span>
            </li>`;
        });

        // Adjust the total for the promo code if applicable
        let discount = 5; // Example discount value
        total = Math.max(total - discount, 0);

        // Add discount and total to cart HTML
        cartHtml += `
            <li class="list-group-item d-flex justify-content-between lh-condensed active">
              <div class="text-dark">
                <h6 class="my-0">Promo code</h6>
                <small>EXAMPLECODE</small>
              </div>
              <span>-₹${discount.toFixed(2)}</span>
            </li>
            <li class="list-group-item d-flex lh-condensed justify-content-between">
              <span class="fw-bold">Total (USD)</span>
              <strong>₹${total.toFixed(2)}</strong>
            </li>
          </ul>
        </div>`;

        // Insert the cart HTML into the small_cart div
        cartContainer.innerHTML = cartHtml;

      } catch (error) {
        console.error('Error fetching cart data:', error);
      }
    }

    // Call the updateCartHtml function on DOM content load
    document.addEventListener('DOMContentLoaded', updateCartHtml);
</script>



</body>

</html>